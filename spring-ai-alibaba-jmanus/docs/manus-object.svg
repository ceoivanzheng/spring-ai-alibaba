<svg width="1400" height="900" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .title { font-family: Arial, sans-serif; font-size: 20px; font-weight: bold; fill: #2c3e50; text-anchor: middle; }
      .section-title { font-family: Arial, sans-serif; font-size: 16px; font-weight: bold; fill: #34495e; }
      .object-title { font-family: Arial, sans-serif; font-size: 12px; font-weight: bold; fill: #ffffff; text-anchor: middle; }
      .object-field { font-family: Arial, sans-serif; font-size: 9px; fill: #2c3e50; }
      .object-value { font-family: Arial, sans-serif; font-size: 8px; fill: #7f8c8d; }
      .relation-text { font-family: Arial, sans-serif; font-size: 9px; fill: #e74c3c; font-weight: bold; }
      .note-text { font-family: Arial, sans-serif; font-size: 8px; fill: #34495e; }
      .arrow { stroke: #e74c3c; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
      .dashed-arrow { stroke: #95a5a6; stroke-width: 1; stroke-dasharray: 5,5; fill: none; marker-end: url(#arrowhead-gray); }
    </style>
    
    <!-- Arrow markers -->
    <marker id="arrowhead" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <polygon points="0 0, 8 3, 0 6" fill="#e74c3c"/>
    </marker>
    
    <marker id="arrowhead-gray" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <polygon points="0 0, 8 3, 0 6" fill="#95a5a6"/>
    </marker>
    
    <!-- Gradients for different object types -->
    <linearGradient id="configGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#3498db;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#2980b9;stop-opacity:1" />
    </linearGradient>
    
    <linearGradient id="executionGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#e74c3c;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#c0392b;stop-opacity:1" />
    </linearGradient>
    
    <linearGradient id="toolGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#f39c12;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#e67e22;stop-opacity:1" />
    </linearGradient>

    <linearGradient id="auxGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#9b59b6;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#8e44ad;stop-opacity:1" />
    </linearGradient>
  </defs>
  
  <!-- Background -->
  <rect width="1400" height="900" fill="#f8f9fa"/>
  
  <!-- Title -->
  <text x="700" y="30" class="title">JManus 核心对象关系图 (Object Diagram)</text>
  <text x="700" y="50" class="section-title" text-anchor="middle">系统在特定时刻的对象实例快照</text>
  
  <!-- Configuration Objects Section -->
  <text x="50" y="90" class="section-title">配置管理对象</text>
  
  <!-- DynamicModelEntity -->
  <g id="model1">
    <rect x="50" y="100" width="200" height="120" fill="url(#configGrad)" rx="5"/>
    <text x="150" y="118" class="object-title">model1: DynamicModelEntity</text>
    <rect x="50" y="120" width="200" height="100" fill="#ffffff" stroke="#2980b9"/>
    <text x="55" y="135" class="object-field">id = 1</text>
    <text x="55" y="148" class="object-field">modelName = "qwen-max"</text>
    <text x="55" y="161" class="object-field">provider = "alibaba"</text>
    <text x="55" y="174" class="object-field">type = "CHAT"</text>
    <text x="55" y="187" class="object-field">baseUrl = "https://dashscope..."</text>
    <text x="55" y="200" class="object-value">apiKey = "sk-****"</text>
    <text x="55" y="213" class="object-value">modelDescription = "通义千问大模型"</text>
  </g>
  
  <!-- DynamicAgentEntity 1 -->
  <g id="agent1">
    <rect x="280" y="100" width="220" height="120" fill="url(#configGrad)" rx="5"/>
    <text x="390" y="118" class="object-title">agent1: DynamicAgentEntity</text>
    <rect x="280" y="120" width="220" height="100" fill="#ffffff" stroke="#2980b9"/>
    <text x="285" y="135" class="object-field">id = 1</text>
    <text x="285" y="148" class="object-field">agentName = "ReActAgent"</text>
    <text x="285" y="161" class="object-field">agentDescription = "反应式智能体"</text>
    <text x="285" y="174" class="object-field">className = "...ReActAgent"</text>
    <text x="285" y="187" class="object-field">namespace = "default"</text>
    <text x="285" y="200" class="object-value">availableToolKeys = ["browser-tool", "python-tool"]</text>
    <text x="285" y="213" class="object-value">modelId = 1</text>
  </g>
  
  <!-- DynamicAgentEntity 2 -->
  <g id="agent2">
    <rect x="530" y="100" width="220" height="120" fill="url(#configGrad)" rx="5"/>
    <text x="640" y="118" class="object-title">agent2: DynamicAgentEntity</text>
    <rect x="530" y="120" width="220" height="100" fill="#ffffff" stroke="#2980b9"/>
    <text x="535" y="135" class="object-field">id = 2</text>
    <text x="535" y="148" class="object-field">agentName = "PlanAgent"</text>
    <text x="535" y="161" class="object-field">agentDescription = "计划式智能体"</text>
    <text x="535" y="174" class="object-field">className = "...PlanAgent"</text>
    <text x="535" y="187" class="object-field">namespace = "default"</text>
    <text x="535" y="200" class="object-value">availableToolKeys = ["file-tool", "bash-tool"]</text>
    <text x="535" y="213" class="object-value">modelId = 1</text>
  </g>
  
  <!-- McpConfigEntity -->
  <g id="mcpConfig1">
    <rect x="780" y="100" width="200" height="120" fill="url(#configGrad)" rx="5"/>
    <text x="880" y="118" class="object-title">mcpConfig1: McpConfigEntity</text>
    <rect x="780" y="120" width="200" height="100" fill="#ffffff" stroke="#2980b9"/>
    <text x="785" y="135" class="object-field">id = 1</text>
    <text x="785" y="148" class="object-field">mcpServerName = "github-mcp"</text>
    <text x="785" y="161" class="object-field">connectionType = "STUDIO"</text>
    <text x="785" y="174" class="object-value">connectionConfig = "{</text>
    <text x="785" y="187" class="object-value">  \"command\": \"npx\",</text>
    <text x="785" y="200" class="object-value">  \"args\": [\"@modelcontextprotocol/</text>
    <text x="785" y="213" class="object-value">    server-github\"]}"</text>
  </g>
  
  <!-- Execution Records Section -->
  <text x="50" y="270" class="section-title">执行记录对象</text>
  
  <!-- PlanExecutionRecord -->
  <g id="planRecord1">
    <rect x="50" y="280" width="280" height="140" fill="url(#executionGrad)" rx="5"/>
    <text x="190" y="298" class="object-title">planRecord1: PlanExecutionRecord</text>
    <rect x="50" y="300" width="280" height="120" fill="#ffffff" stroke="#c0392b"/>
    <text x="55" y="315" class="object-field">id = 1001</text>
    <text x="55" y="328" class="object-field">currentPlanId = "plan-2025-001"</text>
    <text x="55" y="341" class="object-field">rootPlanId = "plan-2025-001"</text>
    <text x="55" y="354" class="object-field">title = "数据分析任务"</text>
    <text x="55" y="367" class="object-field">userRequest = "分析销售数据并生成报告"</text>
    <text x="55" y="380" class="object-value">startTime = "2025-01-18T10:00:00"</text>
    <text x="55" y="393" class="object-value">endTime = "2025-01-18T10:30:00"</text>
    <text x="55" y="406" class="object-value">completed = true, currentStepIndex = 2</text>
  </g>
  
  <!-- AgentExecutionRecord 1 -->
  <g id="agentExecRecord1">
    <rect x="360" y="280" width="250" height="140" fill="url(#executionGrad)" rx="5"/>
    <text x="485" y="298" class="object-title">agentExecRecord1: AgentExecutionRecord</text>
    <rect x="360" y="300" width="250" height="120" fill="#ffffff" stroke="#c0392b"/>
    <text x="365" y="315" class="object-field">id = 2001</text>
    <text x="365" y="328" class="object-field">conversationId = "conv-001"</text>
    <text x="365" y="341" class="object-field">agentName = "ReActAgent"</text>
    <text x="365" y="354" class="object-field">status = "FINISHED"</text>
    <text x="365" y="367" class="object-field">maxSteps = 5, currentStep = 3</text>
    <text x="365" y="380" class="object-value">startTime = "2025-01-18T10:00:00"</text>
    <text x="365" y="393" class="object-value">endTime = "2025-01-18T10:15:00"</text>
    <text x="365" y="406" class="object-value">result = "数据分析完成"</text>
  </g>
  
  <!-- AgentExecutionRecord 2 -->
  <g id="agentExecRecord2">
    <rect x="640" y="280" width="250" height="140" fill="url(#executionGrad)" rx="5"/>
    <text x="765" y="298" class="object-title">agentExecRecord2: AgentExecutionRecord</text>
    <rect x="640" y="300" width="250" height="120" fill="#ffffff" stroke="#c0392b"/>
    <text x="645" y="315" class="object-field">id = 2002</text>
    <text x="645" y="328" class="object-field">conversationId = "conv-001"</text>
    <text x="645" y="341" class="object-field">agentName = "PlanAgent"</text>
    <text x="645" y="354" class="object-field">status = "FINISHED"</text>
    <text x="645" y="367" class="object-field">maxSteps = 3, currentStep = 3</text>
    <text x="645" y="380" class="object-value">startTime = "2025-01-18T10:15:00"</text>
    <text x="645" y="393" class="object-value">endTime = "2025-01-18T10:30:00"</text>
    <text x="645" y="406" class="object-value">result = "报告生成完成"</text>
  </g>
  
  <!-- Think-Act Records Section -->
  <text x="50" y="460" class="section-title">思考-行动记录对象</text>
  
  <!-- ThinkActRecord 1 -->
  <g id="thinkActRecord1">
    <rect x="50" y="470" width="200" height="130" fill="url(#toolGrad)" rx="5"/>
    <text x="150" y="488" class="object-title">thinkActRecord1</text>
    <rect x="50" y="490" width="200" height="110" fill="#ffffff" stroke="#e67e22"/>
    <text x="55" y="505" class="object-field">id = 3001</text>
    <text x="55" y="518" class="object-field">parentExecutionId = 2001</text>
    <text x="55" y="531" class="object-field">status = "SUCCESS"</text>
    <text x="55" y="544" class="object-field">toolName = "python-tool"</text>
    <text x="55" y="557" class="object-value">thinkInput = "需要分析销售数据"</text>
    <text x="55" y="570" class="object-value">thinkOutput = "使用Python工具..."</text>
    <text x="55" y="583" class="object-value">actionResult = "成功加载数据"</text>
  </g>
  
  <!-- ThinkActRecord 2 -->
  <g id="thinkActRecord2">
    <rect x="280" y="470" width="200" height="130" fill="url(#toolGrad)" rx="5"/>
    <text x="380" y="488" class="object-title">thinkActRecord2</text>
    <rect x="280" y="490" width="200" height="110" fill="#ffffff" stroke="#e67e22"/>
    <text x="285" y="505" class="object-field">id = 3002</text>
    <text x="285" y="518" class="object-field">parentExecutionId = 2001</text>
    <text x="285" y="531" class="object-field">status = "SUCCESS"</text>
    <text x="285" y="544" class="object-field">toolName = "browser-tool"</text>
    <text x="285" y="557" class="object-value">thinkInput = "数据已分析"</text>
    <text x="285" y="570" class="object-value">thinkOutput = "使用浏览器工具..."</text>
    <text x="285" y="583" class="object-value">actionResult = "成功创建图表"</text>
  </g>
  
  <!-- ThinkActRecord 3 -->
  <g id="thinkActRecord3">
    <rect x="510" y="470" width="200" height="130" fill="url(#toolGrad)" rx="5"/>
    <text x="610" y="488" class="object-title">thinkActRecord3</text>
    <rect x="510" y="490" width="200" height="110" fill="#ffffff" stroke="#e67e22"/>
    <text x="515" y="505" class="object-field">id = 3003</text>
    <text x="515" y="518" class="object-field">parentExecutionId = 2002</text>
    <text x="515" y="531" class="object-field">status = "SUCCESS"</text>
    <text x="515" y="544" class="object-field">toolName = "file-tool"</text>
    <text x="515" y="557" class="object-value">thinkInput = "需要生成分析报告"</text>
    <text x="515" y="570" class="object-value">thinkOutput = "使用文件工具..."</text>
    <text x="515" y="583" class="object-value">actionResult = "成功生成报告"</text>
  </g>
  
  <!-- Tool Info Objects -->
  <text x="50" y="640" class="section-title">工具信息对象</text>
  
  <!-- ActToolInfo 1 -->
  <g id="actToolInfo1">
    <rect x="50" y="650" width="180" height="80" fill="url(#auxGrad)" rx="5"/>
    <text x="140" y="668" class="object-title">actToolInfo1</text>
    <rect x="50" y="670" width="180" height="60" fill="#ffffff" stroke="#8e44ad"/>
    <text x="55" y="685" class="object-field">name = "python-tool"</text>
    <text x="55" y="698" class="object-field">id = "tool-001"</text>
    <text x="55" y="711" class="object-value">parameters = "{\"script\": \"sales_analysis.py\"}"</text>
    <text x="55" y="724" class="object-value">result = "数据分析结果: 销售增长15%"</text>
  </g>
  
  <!-- ActToolInfo 2 -->
  <g id="actToolInfo2">
    <rect x="260" y="650" width="180" height="80" fill="url(#auxGrad)" rx="5"/>
    <text x="350" y="668" class="object-title">actToolInfo2</text>
    <rect x="260" y="670" width="180" height="60" fill="#ffffff" stroke="#8e44ad"/>
    <text x="265" y="685" class="object-field">name = "browser-tool"</text>
    <text x="265" y="698" class="object-field">id = "tool-002"</text>
    <text x="265" y="711" class="object-value">parameters = "{\"url\": \"chart.html\"}"</text>
    <text x="265" y="724" class="object-value">result = "图表创建成功"</text>
  </g>
  
  <!-- UserInputWaitState -->
  <g id="userInputState1">
    <rect x="470" y="650" width="180" height="80" fill="url(#auxGrad)" rx="5"/>
    <text x="560" y="668" class="object-title">userInputState1</text>
    <rect x="470" y="670" width="180" height="60" fill="#ffffff" stroke="#8e44ad"/>
    <text x="475" y="685" class="object-field">waitingForInput = false</text>
    <text x="475" y="698" class="object-field">inputReceived = true</text>
    <text x="475" y="711" class="object-value">inputPrompt = "请确认是否继续执行"</text>
    <text x="475" y="724" class="object-value">userResponse = "继续"</text>
  </g>
  
  <!-- Relationships -->
  <!-- Model to Agents -->
  <line x1="250" y1="160" x2="280" y2="160" class="arrow"/>
  <text x="260" y="155" class="relation-text" text-anchor="middle">使用</text>
  
  <line x1="250" y1="180" x2="530" y2="180" class="arrow"/>
  <text x="390" y="175" class="relation-text" text-anchor="middle">使用</text>
  
  <!-- Plan to Agent Records -->
  <line x1="190" y1="420" x2="485" y2="280" class="arrow"/>
  <text x="300" y="340" class="relation-text">包含</text>
  
  <line x1="190" y1="420" x2="765" y2="280" class="arrow"/>
  <text x="450" y="340" class="relation-text">包含</text>
  
  <!-- Agent Records to Think-Act Records -->
  <line x1="485" y1="420" x2="150" y2="470" class="arrow"/>
  <text x="300" y="440" class="relation-text">包含</text>
  
  <line x1="485" y1="420" x2="380" y2="470" class="arrow"/>
  <text x="430" y="440" class="relation-text">包含</text>
  
  <line x1="765" y1="420" x2="610" y2="470" class="arrow"/>
  <text x="680" y="440" class="relation-text">包含</text>
  
  <!-- Think-Act to Tool Info -->
  <line x1="150" y1="600" x2="140" y2="650" class="arrow"/>
  <text x="120" y="625" class="relation-text">调用</text>
  
  <line x1="380" y1="600" x2="350" y2="650" class="arrow"/>
  <text x="340" y="625" class="relation-text">调用</text>
  
  <!-- Plan to UserInput (dashed) -->
  <line x1="330" y1="350" x2="560" y2="650" class="dashed-arrow"/>
  <text x="430" y="500" class="relation-text">关联</text>
  
  <!-- MCP Config (dashed to agents) -->
  <line x1="780" y1="140" x2="500" y2="140" class="dashed-arrow"/>
  <text x="640" y="135" class="relation-text">可能使用</text>
  
  <!-- Object Hierarchy Diagram -->
  <g id="hierarchy">
    <rect x="1020" y="100" width="320" height="450" fill="#ecf0f1" stroke="#bdc3c7" stroke-width="2" rx="8"/>
    <text x="1180" y="125" class="section-title" text-anchor="middle">对象层次结构</text>
    
    <!-- Level 1: Plan -->
    <rect x="1040" y="140" width="280" height="30" fill="#e74c3c" rx="5"/>
    <text x="1180" y="158" class="object-title">PlanExecutionRecord (计划)</text>
    
    <!-- Level 2: Agent Records -->
    <rect x="1060" y="190" width="120" height="25" fill="#f39c12" rx="3"/>
    <text x="1120" y="206" class="object-title" style="font-size: 10px;">AgentExecRecord1</text>
    
    <rect x="1200" y="190" width="120" height="25" fill="#f39c12" rx="3"/>
    <text x="1260" y="206" class="object-title" style="font-size: 10px;">AgentExecRecord2</text>
    
    <!-- Level 3: Think-Act Records -->
    <rect x="1050" y="235" width="80" height="20" fill="#27ae60" rx="2"/>
    <text x="1090" y="247" class="object-title" style="font-size: 8px;">ThinkAct1</text>
    
    <rect x="1140" y="235" width="80" height="20" fill="#27ae60" rx="2"/>
    <text x="1180" y="247" class="object-title" style="font-size: 8px;">ThinkAct2</text>
    
    <rect x="1230" y="235" width="80" height="20" fill="#27ae60" rx="2"/>
    <text x="1270" y="247" class="object-title" style="font-size: 8px;">ThinkAct3</text>
    
    <!-- Level 4: Tool Info -->
    <rect x="1055" y="275" width="70" height="15" fill="#9b59b6" rx="2"/>
    <text x="1090" y="285" class="object-title" style="font-size: 7px;">Tool1</text>
    
    <rect x="1145" y="275" width="70" height="15" fill="#9b59b6" rx="2"/>
    <text x="1180" y="285" class="object-title" style="font-size: 7px;">Tool2</text>
    
    <!-- Hierarchy Lines -->
    <line x1="1180" y1="170" x2="1120" y2="190" stroke="#7f8c8d" stroke-width="1"/>
    <line x1="1180" y1="170" x2="1260" y2="190" stroke="#7f8c8d" stroke-width="1"/>
    <line x1="1120" y1="215" x2="1090" y2="235" stroke="#7f8c8d" stroke-width="1"/>
    <line x1="1120" y1="215" x2="1180" y2="235" stroke="#7f8c8d" stroke-width="1"/>
    <line x1="1260" y1="215" x2="1270" y2="235" stroke="#7f8c8d" stroke-width="1"/>
    <line x1="1090" y1="255" x2="1090" y2="275" stroke="#7f8c8d" stroke-width="1"/>
    <line x1="1180" y1="255" x2="1180" y2="275" stroke="#7f8c8d" stroke-width="1"/>
    
    <!-- Features -->
    <text x="1040" y="320" class="section-title" style="font-size: 12px;">核心特性</text>
    <text x="1045" y="340" class="note-text">• 层次化结构设计</text>
    <text x="1045" y="355" class="note-text">• 支持递归子计划</text>
    <text x="1045" y="370" class="note-text">• 配置与执行分离</text>
    <text x="1045" y="385" class="note-text">• 完整时间序列跟踪</text>
    <text x="1045" y="400" class="note-text">• 工具调用详细记录</text>
    
    <text x="1040" y="430" class="section-title" style="font-size: 12px;">应用场景</text>
    <text x="1045" y="450" class="note-text">• 计划执行跟踪</text>
    <text x="1045" y="465" class="note-text">• 智能体行为分析</text>
    <text x="1045" y="480" class="note-text">• 工具使用统计</text>
    <text x="1045" y="495" class="note-text">• 错误诊断和调试</text>
    <text x="1045" y="510" class="note-text">• 性能优化分析</text>

    <rect x="1030" y="740" width="20" height="15" fill="url(#auxGrad)" rx="2"/>
    <text x="1060" y="752" class="note-text">辅助对象 (Tool Info, User State)</text>

    <line x1="1250" y1="685" x2="1280" y2="685" class="arrow"/>
    <text x="1290" y="690" class="note-text">强关联关系</text>

    <line x1="1250" y1="705" x2="1280" y2="705" class="dashed-arrow"/>
    <text x="1290" y="710" class="note-text">弱关联关系</text>

    <text x="1040" y="735" class="section-title" style="font-size: 12px;">关系类型</text>
    <text x="1045" y="755" class="note-text">• 实线箭头: 直接包含/使用关系</text>
    <text x="1045" y="770" class="note-text">• 虚线箭头: 可能使用/间接关系</text>
    <text x="1045" y="785" class="note-text">• 一对一: 单一实例关联</text>
    <text x="1045" y="800" class="note-text">• 一对多: 集合包含关系</text>

    <text x="1040" y="825" class="section-title" style="font-size: 12px;">对象特点</text>
    <text x="1045" y="845" class="note-text">• 所有对象都有唯一ID标识</text>
    <text x="1045" y="860" class="note-text">• 支持时间序列记录和追踪</text>
    <text x="1045" y="875" class="note-text">• 配置与执行完全分离设计</text>
  </g>

  <!-- Legend -->
  <g id="legend">
    <rect x="1020" y="650" width="320" height="200" fill="#ffffff" stroke="#bdc3c7" stroke-width="1" rx="5"/>
    <text x="1180" y="670" class="section-title" text-anchor="middle">图例说明</text>

    <rect x="1030" y="680" width="20" height="15" fill="url(#configGrad)" rx="2"/>
    <text x="1060" y="692" class="note-text">配置管理对象 (Model, Agent, MCP)</text>

    <rect x="1030" y="700" width="20" height="15" fill="url(#executionGrad)" rx="2"/>
    <text x="1060" y="712" class="note-text">执行记录对象 (Plan, Agent执行)</text>

    <rect x="1030" y="720" width="20" height="15" fill="url(#toolGrad)" rx="2"/>
    <text x="1060" y="732" class="note-text">思考-行动记录 (Think-Act)</text>
  </g>

  <!-- Summary Information -->
  <text x="700" y="880" class="section-title" text-anchor="middle" style="font-size: 14px;">
    JManus 对象图 - 展示系统在2025-01-18T10:00:00时刻的对象实例快照
  </text>
  <text x="700" y="895" class="note-text" text-anchor="middle">
    文档版本: 1.0 | 创建日期: 2025年1月 | 维护者: Spring AI Alibaba Team
  </text>
</svg>